See https://www.sitepoint.com/devise-authentication-in-depth/  Devise Authentication in Depth
